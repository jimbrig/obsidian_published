<!DOCTYPE html><html lang=en> <head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width, initial-scale=1.0"><meta name=description content="Personal Obsidian Vault Published using MkDocs"><meta name=author content="Jimmy Briggs"><link href=https://vault.jimbrig.com/Windows/SFC%20and%20DISM%20Commands/ rel=canonical><link rel="shortcut icon" href=../../img/favicon.ico><title>SFC Scannow and DISM Commands - Jims Obsidian Vault</title><link rel=stylesheet href=https://use.fontawesome.com/releases/v5.12.0/css/all.css><link rel=stylesheet href=https://use.fontawesome.com/releases/v5.12.0/css/v4-shims.css><link rel=stylesheet href=//cdn.jsdelivr.net/npm/hack-font@3.3.0/build/web/hack.min.css><link href=//rsms.me/inter/inter.css rel=stylesheet type=text/css><link href="//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,700italic,400,300,600,700&subset=latin-ext,latin" rel=stylesheet type=text/css><link href=../../css/bootstrap-custom.min.css rel=stylesheet><link href=../../css/base.min.css rel=stylesheet><link href=../../css/cinder.min.css rel=stylesheet><link rel=stylesheet href=//cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.18.0/build/styles/dracula.min.css><link href=../../css/timeago.css rel=stylesheet><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries --><!--[if lt IE 9]>
            <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
            <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
        <![endif]--></head> <body> <div class="navbar navbar-default navbar-fixed-top" role=navigation> <div class=container> <!-- Collapsed navigation --> <div class=navbar-header> <!-- Expander button --> <button type=button class=navbar-toggle data-toggle=collapse data-target=.navbar-collapse> <span class=sr-only>Toggle navigation</span> <span class=icon-bar></span> <span class=icon-bar></span> <span class=icon-bar></span> </button> <!-- Main title --> <a class=navbar-brand href=../..>Jims Obsidian Vault</a> </div> <!-- Expanded navigation --> <div class="navbar-collapse collapse"> <!-- Main navigation --> <ul class="nav navbar-nav"> <li> <a href=../..>Home</a> </li> <li> <a href=../../setup/ >Setup</a> </li> <li class="dropdown active"> <a href=# class=dropdown-toggle data-toggle=dropdown>Categories <b class=caret></b></a> <ul class=dropdown-menu> <li class=dropdown-submenu> <a tabindex=-1 href>Daily Notes</a> <ul class=dropdown-menu> <li class=dropdown-submenu> <a tabindex=-1 href>Daily</a> <ul class=dropdown-menu> <li> <a href=../../_daily/ >Daily Notes</a> </li> <li> <a href=../../_daily/2020-04-20/ >2020 04 20</a> </li> <li> <a href=../../_daily/2021-04-21/ >2021 04 21</a> </li> <li> <a href=../../_daily/2021-04-22/ >2021 04 22</a> </li> <li> <a href=../../_daily/2021-04-23/ >2021 04 23</a> </li> <li> <a href=../../_daily/2021-04-24/ >2021 04 24</a> </li> <li> <a href=../../_daily/2021-04-25/ >2021 04 25</a> </li> <li> <a href=../../_daily/2021-04-28/ >2021 04 28</a> </li> <li> <a href=../../_daily/2021-04-29/ >2021 04 29</a> </li> <li> <a href=../../_daily/2021-05-01/ >2021 05 01</a> </li> <li> <a href=../../_daily/2021-05-02/ >2021 05 02</a> </li> <li> <a href=../../_daily/2021-05-03/ >2021 05 03</a> </li> <li> <a href=../../_daily/2021-05-04/ >2021 05 04</a> </li> </ul> </li> </ul> </li> <li class=dropdown-submenu> <a tabindex=-1 href>Featured</a> <ul class=dropdown-menu> <li class=dropdown-submenu> <a tabindex=-1 href>R</a> <ul class=dropdown-menu> <li> <a href=../../R/ >R</a> </li> <li> <a href=../../R/Base%20Package%20Hidden%20Gems%20in%20R/ >Base Package Hidden Gems in R ðŸ’Ž</a> </li> <li> <a href=../../R/Data%20Validation%20Packages%20in%20R/ >Data Validation Packages and Tools in R</a> </li> <li> <a href=../../R/Databases%20with%20R%20Resources/ >Databases with R Resources</a> </li> <li> <a href=../../R/EDA%20Packages%20in%20R/ >EDA Packages in R</a> </li> <li> <a href=../../R/Plumber%20Logging/ >Plumber Logging</a> </li> <li> <a href=../../R/Plumber%20REST%20APIs%20in%20R/ >Building REST APIs with R and Plumber</a> </li> <li> <a href=../../R/Plumber%20Resources/ >Plumber Resources</a> </li> <li> <a href=../../R/R%20Books/ >R-Books</a> </li> <li> <a href=../../R/R%20Development/ >R Development</a> </li> <li> <a href=../../R/R%20Miscellaneous%20Notes/ >R Miscellaneous Notes</a> </li> <li> <a href=../../R/R%20Shiny%20Packages/ >R Shiny Resources</a> </li> <li> <a href=../../R/RStudio%20Configuration%20Notes/ >RStudio Configuration</a> </li> <li> <a href=../../R/Shiny%20Apps%20as%20Packages%20in%20R/ >Shiny Apps as Packages in R</a> </li> <li> <a href=../../R/Tools%20Package%20Hidden%20Gems%20in%20R/ >Tools Package Hidden Gems in R</a> </li> <li> <a href=../../R/Useful%20Packages%20in%20R%20List/ >Useful R Packages to Look Into</a> </li> <li> <a href=../../R/Utils%20Package%20Hidden%20Gems%20in%20R/ >Utils Package Hidden Gems</a> </li> </ul> </li> <li class=dropdown-submenu> <a tabindex=-1 href>GCP</a> <ul class=dropdown-menu> <li> <a href=../../GCP/ >GCP</a> </li> <li> <a href=../../GCP/Google%20Cloud%20APIs/ >Google Cloud APIs</a> </li> <li> <a href=../../GCP/Google%20Cloud%20Setup%20Notes/ >Google Cloud Setup Notes</a> </li> <li> <a href=../../GCP/Install%20gcloud%20SDK%20on%20Ubuntu/ >Install gcloud SDK on Ubuntu</a> </li> <li> <a href=../../GCP/Install%20gcloud%20SDK%20on%20Windows/ >Install gcloud SDK on Windows</a> </li> <li> <a href=../../GCP/Setup%20Cloud%20SQL%20for%20PostgreSQL%20in%20Production/ >Setup Cloud SQL for PostgreSQL in Production</a> </li> </ul> </li> <li class=dropdown-submenu> <a tabindex=-1 href>Databases</a> <ul class=dropdown-menu> <li> <a href=../../Databases/ >Databases</a> </li> <li> <a href=../../Databases/Database%20GUIs/ >Database GUIs</a> </li> <li> <a href=../../Databases/Databases/ >Databases - MOC</a> </li> <li> <a href=../../Databases/PostgreSQL%20Tools/ >PostgreSQL Tools</a> </li> <li> <a href=../../Databases/PostgreSQL/ >PostgreSQL</a> </li> <li> <a href=../../Databases/Views%20vs.%20Materialized%20Views/ >Views vs. Materialized Views</a> </li> </ul> </li> <li class=dropdown-submenu> <a tabindex=-1 href>Windows</a> <ul class=dropdown-menu> <li> <a href=../ >Windows</a> </li> <li> <a href=../How%20to%20Cleanup%20Windows%20from%20Command%20Line/ >How to Cleanup Windows from Command Line</a> </li> <li class=active> <a href=./ >SFC Scannow and DISM Commands</a> </li> <li> <a href=../Using%20diskusage%20Command%20in%20Windows/ >Using diskusage Command in Windows</a> </li> <li> <a href=../WinGet%20CLI%20Setup%20and%20Settings/ >WinGet CLI Settings</a> </li> <li> <a href=../Windows%20Command%20Line%20Commands%20Overview/ >Windows Command Prompt</a> </li> </ul> </li> <li class=dropdown-submenu> <a tabindex=-1 href>WSL</a> <ul class=dropdown-menu> <li> <a href=../../WSL/ >WSL</a> </li> <li> <a href=../../WSL/WSL%20Commands%20and%20Installs/ >WSL Commands and Installs</a> </li> <li> <a href=../../WSL/WSL%20Ubuntu%20on%20Windows%20Community%20Preview/ >WSL Ubuntu on Windows Community Preview</a> </li> <li> <a href=../../WSL/WSL/ >WSL- Contents</a> </li> <li> <a href=../../WSL/WSLg/ >WSLg</a> </li> </ul> </li> <li class=dropdown-submenu> <a tabindex=-1 href>System Design</a> <ul class=dropdown-menu> <li> <a href=../../System%20Design/ >System Design</a> </li> <li> <a href=../../System%20Design/System%20Design%20Primer/ >System Design Primer</a> </li> <li> <a href=../../System%20Design/System%20Design/ >System Design</a> </li> </ul> </li> </ul> </li> <li class=dropdown-submenu> <a tabindex=-1 href>Everything</a> <ul class=dropdown-menu> <li class=dropdown-submenu> <a tabindex=-1 href>Cloud</a> <ul class=dropdown-menu> <li> <a href=../../Cloud/ >Cloud</a> </li> <li> <a href=../../Cloud/Google%20Cloud%20Setup%20Notes/ >Google Cloud Setup Notes</a> </li> </ul> </li> <li class=dropdown-submenu> <a tabindex=-1 href>Developer Tools</a> <ul class=dropdown-menu> <li> <a href=../../Developer%20Tools/ >Developer Tools</a> </li> <li class=dropdown-submenu> <a tabindex=-1 href>Web Browsers</a> <ul class=dropdown-menu> <li> <a href=../../Developer%20Tools/Web%20Browsers/ >Web Browsers</a> </li> <li> <a href=../../Developer%20Tools/Web%20Browsers/Firefox%20Developer%20Edition/ >Firefox Developer Edition</a> </li> <li> <a href=../../Developer%20Tools/Web%20Browsers/Web%20Browsers/ >Web Browsers</a> </li> </ul> </li> </ul> </li> <li class=dropdown-submenu> <a tabindex=-1 href>Docker</a> <ul class=dropdown-menu> <li> <a href=../../Docker/ >Docker</a> </li> <li> <a href=../../Docker/Docker%20Compose%20Reference%20Docs/ >Docker Compose Reference Docs</a> </li> <li> <a href=../../Docker/Docker/ >Docker Best Practices</a> </li> </ul> </li> <li class=dropdown-submenu> <a tabindex=-1 href>Documentation</a> <ul class=dropdown-menu> <li> <a href=../../Documentation/ >Documentation</a> </li> <li> <a href=../../Documentation/MkDocs/ >MkDocs</a> </li> </ul> </li> <li class=dropdown-submenu> <a tabindex=-1 href>Git</a> <ul class=dropdown-menu> <li> <a href=../../Git/ >Git</a> </li> <li> <a href=../../Git/Git%20Tools/ >Git Tools</a> </li> </ul> </li> <li class=dropdown-submenu> <a tabindex=-1 href>Github</a> <ul class=dropdown-menu> <li> <a href=../../Github/ >Github</a> </li> <li> <a href=../../Github/Github%20Actions%20for%20R/ >Github Actions for R</a> </li> </ul> </li> <li class=dropdown-submenu> <a tabindex=-1 href>Lists</a> <ul class=dropdown-menu> <li> <a href=../../Lists/ >Lists</a> </li> <li> <a href=../../Lists/Recurring%20Shopping%20List/ >Recurring Shopping List</a> </li> </ul> </li> <li class=dropdown-submenu> <a tabindex=-1 href>Obsidian</a> <ul class=dropdown-menu> <li> <a href=../../Obsidian/ >Obsidian</a> </li> <li> <a href=../../Obsidian/Mermaid%20Diagrams/ >Mermaid Diagrams</a> </li> <li> <a href=../../Obsidian/Obsidian%20Git%20Plugin%20Notes/ >Obsidian Git Plugin Notes</a> </li> <li> <a href=../../Obsidian/Obsidian/ >Obsidian</a> </li> <li> <a href=../../Obsidian/Publishing%20Workflow/ >Publishing Workflow</a> </li> <li> <a href=../../Obsidian/Templater%20Plugin%20Notes/ >Templater Plugin Notes</a> </li> </ul> </li> <li class=dropdown-submenu> <a tabindex=-1 href>PKM</a> <ul class=dropdown-menu> <li> <a href=../../PKM/ >PKM</a> </li> <li> <a href=../../PKM/PKM/ >PKM</a> </li> </ul> </li> <li class=dropdown-submenu> <a tabindex=-1 href>Powwater</a> <ul class=dropdown-menu> <li> <a href=../../Powwater/ >Powwater</a> </li> <li> <a href=../../Powwater/Database%20Documentation/ >Database Documentation</a> </li> </ul> </li> <li class=dropdown-submenu> <a tabindex=-1 href>Productivity</a> <ul class=dropdown-menu> <li> <a href=../../Productivity/ >Productivity</a> </li> <li> <a href=../../Productivity/Notes%20on%20Finishing%20Projects/ >Notes on Finishing Projects</a> </li> <li> <a href=../../Productivity/Productivity/ >Productivity</a> </li> <li> <a href=../../Productivity/Time%20Management/ >Time Management</a> </li> </ul> </li> <li class=dropdown-submenu> <a tabindex=-1 href>Project Management</a> <ul class=dropdown-menu> <li> <a href=../../Project%20Management/ >Project Management</a> </li> <li> <a href=../../Project%20Management/Ludicrously%20Complex%20Projects%20in%20Software%20Development/ >Ludicrously Complex Projects</a> </li> <li> <a href=../../Project%20Management/Project%20Management%20Pipeline/ >Project Management Pipeline</a> </li> <li> <a href=../../Project%20Management/Project%20Management/ >Project Management</a> </li> <li> <a href=../../Project%20Management/Taming%20a%20Chaotic%20Project/ >Taming a Chaotic Project</a> </li> </ul> </li> <li class=dropdown-submenu> <a tabindex=-1 href>Python</a> <ul class=dropdown-menu> <li> <a href=../../Python/ >Python</a> </li> <li> <a href=../../Python/Python/ >Python</a> </li> </ul> </li> <li class=dropdown-submenu> <a tabindex=-1 href>R</a> <ul class=dropdown-menu> <li class=dropdown-submenu> <a tabindex=-1 href>Databases with R</a> <ul class=dropdown-menu> <li> <a href=../../R/Databases%20with%20R/ >Databases with R</a> </li> <li> <a href=../../R/Databases%20with%20R/Using%20Pool/ >Using Pool, DBI, and Other Drivers</a> </li> </ul> </li> </ul> </li> <li class=dropdown-submenu> <a tabindex=-1 href>Tools</a> <ul class=dropdown-menu> <li> <a href=../../Tools/ >Tools</a> </li> <li class=dropdown-submenu> <a tabindex=-1 href>Web Browsers</a> <ul class=dropdown-menu> <li> <a href=../../Tools/Web%20Browsers/ >Web Browsers</a> </li> <li> <a href=../../Tools/Web%20Browsers/Firefox%20Developer%20Edition/ >Firefox Developer Edition</a> </li> <li> <a href=../../Tools/Web%20Browsers/Web%20Browsers/ >Web Browsers</a> </li> </ul> </li> </ul> </li> <li class=dropdown-submenu> <a tabindex=-1 href>Web Development</a> <ul class=dropdown-menu> <li> <a href=../../Web%20Development/ >Web Development</a> </li> <li> <a href=../../Web%20Development/APIs/ >APIs</a> </li> <li> <a href=../../Web%20Development/Backend%20Web%20Architecture/ >Backend Web Architecture</a> </li> <li> <a href=../../Web%20Development/HTTP%20Requests%20Notes/ >HTTP Requests | Codecademy</a> </li> <li> <a href=../../Web%20Development/Javascript/ >Javascript</a> </li> <li> <a href=../../Web%20Development/WebDev%20Resource%20List/ >WebDev Resource List</a> </li> </ul> </li> </ul> </li> </ul> </li> <li> <a href=../../Changelog/ >Changelog</a> </li> </ul> <ul class="nav navbar-nav navbar-right"> <li> <a href=# data-toggle=modal data-target=#mkdocs_search_modal> <i class="fas fa-search"></i> Search </a> </li> <li> <a href=../How%20to%20Cleanup%20Windows%20from%20Command%20Line/ rel=prev> <i class="fas fa-arrow-left"></i> Previous </a> </li> <li> <a href=../Using%20diskusage%20Command%20in%20Windows/ rel=next> Next <i class="fas fa-arrow-right"></i> </a> </li> <li> <a href="https://github.com/jimbrig/obsidian_published/blob/main/docs/Windows/SFC and DISM Commands.md">Edit on jimbrig/obsidian_published</a> </li> </ul> </div> </div> </div> <div class=container> <div class=col-md-3><div class="bs-sidebar hidden-print affix well" role=complementary> <ul class="nav bs-sidenav"> <li class="first-level active"><a href=#sfc-scannow-and-dism-commands>SFC Scannow and DISM Commands</a></li> <li class=second-level><a href=#sfc>SFC</a></li> <li class=third-level><a href=#add-sfc-scannow-to-desktop-context-menu>Add SFC /Scannow to Desktop Context Menu:</a></li> <li class=second-level><a href=#dism>DISM</a></li> <li class=third-level><a href=#add-dism-to-desktop-context-menu>Add DISM to Desktop Context Menu:</a></li> <li class=third-level><a href=#how-it-works>How it Works</a></li> <li class=third-level><a href=#removing-registry-edits>Removing Registry Edits</a></li> </ul> </div></div> <div class=col-md-9 role=main> <h2 id=sfc-scannow-and-dism-commands>SFC Scannow and DISM Commands<a class=headerlink href=#sfc-scannow-and-dism-commands title="Permanent link">âš‘</a></h2> <p>On Windows 10, when you start noticing random errors, problems booting up, or features not working as expected, there's a good chance that one or multiple system files might have gone missing or corrupted for unknown reasons. Usually, problems with system files could occur as a result of an issue installing a system update, driver, or application, or while making changes to the installation manually.</p> <p>If you happen to come across this issue, you can use the Windows 10 System File Checker (SFC), which is a command-line tool designed to scan the integrity and restore missing or corrupted system files with working replacements.</p> <p>Use the System File Checker tool to repair damaged system files automatically or manually if the tool refuses to work.</p> <hr> <p>On windows these commands are crucial for keeping a clean system. I run these commands so often that I made a <code>.reg</code> registry entry script to add them to my Desktopâ€™s Context Menu (see below for details or visit <a href>my dotfiles repo</a> for the actual <code>.reg</code> scripts to run:</p> <hr> <ol> <li>The <em>System File Checker</em> - <code>sfc /scannow</code></li> <li>The <em>Deployment Image Servicing and Management</em> tool - <code>DISM.exe</code></li> </ol> <p><em>NOTE: these must be ran as an ADMINISTRATOR</em></p> <pre class=codehilite><code class=language-powershell># powershell or CMD as ADMIN

# system file checker
sfc /scannow

# DISM
Dism /Online /Cleanup-Image /ScanHealth
Dism /Online /Cleanup-Image /CheckHealth
Dism /Online /Cleanup-Image /RestoreHealth
</code></pre> <h3 id=sfc>SFC<a class=headerlink href=#sfc title="Permanent link">âš‘</a></h3> <ul> <li>Visit Microsoft's Docs on SFC - <a href=https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/sfc>Link</a></li> </ul> <p>The <code>sfc /scannow</code> command is a well known way to do an integrity check of all Windows 10 system files. <code>sfc.exe</code> is the <em>System File Checker</em> tool which can be helpful in many scenarios and fix various issues with Windows 10. You can save you time by adding a special context menu entry to launch it directly with one click.</p> <h4 id=add-sfc-scannow-to-desktop-context-menu>Add SFC /Scannow to Desktop Context Menu:<a class=headerlink href=#add-sfc-scannow-to-desktop-context-menu title="Permanent link">âš‘</a></h4> <p><img alt=image-20210327021421066 src=../images/75fd153f5ebcd65f454177ebe73be758.png></p> <p>Registry Script:</p> <pre class=codehilite><code class=language-regedit>Windows Registry Editor Version 5.00

[HKEY_CLASSES_ROOT\DesktopBackground\Shell\SFCScannow]
&quot;Icon&quot;=&quot;cmd.exe&quot;
&quot;MUIVerb&quot;=&quot;SFC /Scannow&quot;
&quot;Position&quot;=&quot;Bottom&quot;
&quot;SubCommands&quot;=&quot;&quot;

[HKEY_CLASSES_ROOT\DesktopBackground\shell\SFCScannow\shell\01Scannow]
&quot;HasLUAShield&quot;=&quot;&quot;
&quot;MUIVerb&quot;=&quot;Run SFC /Scannow&quot;

[HKEY_CLASSES_ROOT\DesktopBackground\shell\SFCScannow\shell\01Scannow\command]
@=&quot;PowerShell -windowstyle hidden -command \&quot;Start-Process cmd -ArgumentList '/s,/k, sfc.exe /scannow' -Verb runAs\&quot;&quot;

[HKEY_CLASSES_ROOT\DesktopBackground\shell\SFCScannow\shell\02ViewLog]
&quot;MUIVerb&quot;=&quot;View log for SFC&quot;

[HKEY_CLASSES_ROOT\DesktopBackground\shell\SFCScannow\shell\02ViewLog\command]
@=&quot;PowerShell (Select-String [SR] $env:windir\\Logs\\CBS\\CBS.log -s).Line &gt;\&quot;$env:userprofile\\Desktop\\SFC_LOG.txt\&quot;&quot;
</code></pre> <h3 id=dism>DISM<a class=headerlink href=#dism title="Permanent link">âš‘</a></h3> <ul> <li>Visit Microsoft's Official Docs on DISM - <a href=https://docs.microsoft.com/en-us/windows-hardware/manufacture/desktop/what-is-dism>Link</a></li> <li><a href=https://winaero.com/blog/fix-windows-10-using-dism/ >How to Fix Windows 10 using DISM (winaero.com)</a></li> </ul> <p>Deployment Image Servicing and Management (DISM.exe) is a command-line tool that can be used to service and prepare Windows images, including those used for Windows PE, Windows Recovery Environment (Windows RE) and Windows Setup. DISM can be used to service a Windows image (.wim) or a virtual hard disk (.vhd or.vhdx).</p> <p>The Component store is a core feature of Windows 10 which stores all of the files related to the OS grouped by components and as hardlinks. With new servicing model introduced in Vista, some system files are shared between two components and they are all hardlinked to the system32 folder. When the OS is serviced, the component store is updated. The Component Store is part of the Windows Imaging and Servicing stack.</p> <p>There is a special console tool called DISM which ships with Windows 10 by default. It can be used to fix Windows Component Store corruption. It is especially useful when the usual command "<a href=https://winaero.com/blog/add-sfc-scannow-context-menu-in-windows-10/ >sfc /scannow</a>" cannot repair damaged system files.</p> <p>The DISM tool writes the following log files:</p> <ul> <li>C:\Windows\Logs\CBS\CBS.log</li> <li>C:\Windows\Logs\DISM\dism.log</li> </ul> <p>They can be used to analyze errors and see completed operations.</p> <h4 id=add-dism-to-desktop-context-menu>Add DISM to Desktop Context Menu:<a class=headerlink href=#add-dism-to-desktop-context-menu title="Permanent link">âš‘</a></h4> <p><img alt=image-20210327021344936 src=../images/30a735f876001d6cee61a4dcc976f71a.png></p> <p>Registry Script:</p> <pre class=codehilite><code class=language-regedit>Windows Registry Editor Version 5.00

[HKEY_CLASSES_ROOT\DesktopBackground\Shell\DismContextMenu]
&quot;Icon&quot;=&quot;WmiPrvSE.exe&quot;
&quot;MUIVerb&quot;=&quot;Repair Windows Image&quot;
&quot;Position&quot;=&quot;Bottom&quot;
&quot;SubCommands&quot;=&quot;&quot;

[HKEY_CLASSES_ROOT\DesktopBackground\shell\DismContextMenu\shell\CheckHealth]
&quot;HasLUAShield&quot;=&quot;&quot;
&quot;MUIVerb&quot;=&quot;Check Health of Windows Image&quot;

[HKEY_CLASSES_ROOT\DesktopBackground\shell\DismContextMenu\shell\CheckHealth\command]
@=&quot;PowerShell -windowstyle hidden -command \&quot;Start-Process cmd -ArgumentList '/s,/k, Dism /Online /Cleanup-Image /CheckHealth' -Verb runAs\&quot;&quot;

[HKEY_CLASSES_ROOT\DesktopBackground\shell\DismContextMenu\shell\RestoreHealth]
&quot;HasLUAShield&quot;=&quot;&quot;
&quot;MUIVerb&quot;=&quot;Repair Windows Image&quot;

[HKEY_CLASSES_ROOT\DesktopBackground\shell\DismContextMenu\shell\RestoreHealth\command]
@=&quot;PowerShell -windowstyle hidden -command \&quot;Start-Process cmd -ArgumentList '/s,/k, Dism /Online /Cleanup-Image /RestoreHealth' -Verb runAs\&quot;&quot;
</code></pre> <h4 id=how-it-works>How it Works<a class=headerlink href=#how-it-works title="Permanent link">âš‘</a></h4> <p><em>Check Health of Windows Image.</em> This command executes DISM as follows: <code>Dism /Online /Cleanup-Image /CheckHealth</code>. The key option here is CheckHealth. We use it to check if some process has marked the Component Store as corrupted and whether the corruption is repairable. This command is not supposed to fix any issues. It only reports about problems if they are present and if the CBS store is flagged. This command doesn't create a log file.</p> <p><em>Repair Windows Image</em>. This command starts DISM with the following arguments: <code>Dism /Online /Cleanup-Image /RestoreHealth</code>. The DISM tool started with the /RestoreHealth option will scan the component store for corruption and perform the required repair operations automatically. It will create a log file. The whole process can take several hours, so be patient. On hard drives, it will take longer compared to an SSD.</p> <p>Both commands start <a href=https://winaero.com/blog/start-a-process-elevated-from-powershell/ >elevated from PowerShell</a>.</p> <h4 id=removing-registry-edits>Removing Registry Edits<a class=headerlink href=#removing-registry-edits title="Permanent link">âš‘</a></h4> <p>To undo the Context Menu REGEDIT entries hereâ€™s the scripts:</p> <p>Remove SFC Context Menu:</p> <pre class=codehilite><code>Windows Registry Editor Version 5.00

[-HKEY_CLASSES_ROOT\DesktopBackground\Shell\SFCScannow]
</code></pre> <p>Remove DISM Context Menu:</p> <pre class=codehilite><code class=language-regedit>Windows Registry Editor Version 5.00

[-HKEY_CLASSES_ROOT\DesktopBackground\Shell\DismContextMenu]
</code></pre> <hr> <p>JIMMY BRIGGS - 2021</p></div> </div> <footer class="col-md-12 text-center"> <hr> <p> <small>Copyright &copy; 2021 Jimmy Briggs</small><br> <small>Documentation built with <a href=http://www.mkdocs.org/ >MkDocs</a>.</small> </p> </footer> <script src=//ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js></script> <script src=../../js/bootstrap-3.0.3.min.js></script> <script src=//cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.18.0/build/highlight.min.js></script> <script>hljs.initHighlightingOnLoad();</script> <script>var base_url = "../.."</script> <script src=../../js/base.js></script> <script src=../../js/timeago.min.js></script> <script src=../../js/timeago_mkdocs_material.js></script> <script src=../../search/main.js></script> <div class=modal id=mkdocs_search_modal tabindex=-1 role=dialog aria-labelledby=searchModalLabel aria-hidden=true> <div class="modal-dialog modal-lg"> <div class=modal-content> <div class=modal-header> <button type=button class=close data-dismiss=modal> <span aria-hidden=true>&times;</span> <span class=sr-only>Close</span> </button> <h4 class=modal-title id=searchModalLabel>Search</h4> </div> <div class=modal-body> <p> From here you can search these documents. Enter your search terms below. </p> <form> <div class=form-group> <input type=text class=form-control placeholder=Search... id=mkdocs-search-query title="Type search term here"> </div> </form> <div id=mkdocs-search-results></div> </div> <div class=modal-footer> </div> </div> </div> </div><div class=modal id=mkdocs_keyboard_modal tabindex=-1 role=dialog aria-labelledby=keyboardModalLabel aria-hidden=true> <div class=modal-dialog> <div class=modal-content> <div class=modal-header> <h4 class=modal-title id=keyboardModalLabel>Keyboard Shortcuts</h4> <button type=button class=close data-dismiss=modal><span aria-hidden=true>&times;</span><span class=sr-only>Close</span></button> </div> <div class=modal-body> <table class=table> <thead> <tr> <th style="width: 20%;">Keys</th> <th>Action</th> </tr> </thead> <tbody> <tr> <td class="help shortcut"><kbd>?</kbd></td> <td>Open this help</td> </tr> <tr> <td class="next shortcut"><kbd>n</kbd></td> <td>Next page</td> </tr> <tr> <td class="prev shortcut"><kbd>p</kbd></td> <td>Previous page</td> </tr> <tr> <td class="search shortcut"><kbd>s</kbd></td> <td>Search</td> </tr> </tbody> </table> </div> <div class=modal-footer> </div> </div> </div> </div> </body> </html> 